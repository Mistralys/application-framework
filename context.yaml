$schema: 'https://raw.githubusercontent.com/context-hub/generator/refs/heads/main/json-schema.json'

# CTX Utility Server - To access CTX-specific tools
mcp:
  name: "Framework MCP"
  version: "1.0.0"
  autoload: "vendor/autoload.php"
  directories:
    - src/classes # Scans all sub-modules for #[McpTool]

# MCP SERVER - To access the framework's tools
#
# > This is what actually discovers and serves the tools defined
# > in the codebase.
servers:
  php-mcp:
    command: ["php", "mcp-server.php"]
    env:
      MCP_AUTOLOAD: "vendor/autoload.php"
      MCP_DIRECTORIES: "src/classes"

# DOCUMENT GENERATION - To create documentation from codebase
documents:
  -
    description: 'Application Framework - Class File Structure'
    outputPath: framework-file-structure.md
    overwrite: true
    sources:
      -
        type: tree
        description: 'Tree of PHP Class Files'
        sourcePaths:
          - src/classes
        filePattern: '*'
        renderFormat: ascii
        enabled: true
        showCharCount: true
        maxDepth: 6

  -
    description: 'Application Framework - Core System Overview'
    outputPath: 'framework-core-system-overview.md'
    sources:
      - type: file
        description: "Framework Documentation"
        sourcePaths:
          - docs/agents
        filePattern: "*.md"

## ---------------------------------------------------------------
## DBHELPER
## ---------------------------------------------------------------

  -
    description: 'DBHelper - Overview'
    outputPath: 'modules/db-helper/overview.md'
    sources:
      - type: file
        description: "DBHelper Overview"
        sourcePaths:
          - src/classes/DBHelper/README.md
        filePattern: "README.md"

      - type: file
        description: "DBHelper Documentation"
        sourcePaths:
          - src/classes/DBHelper/Docs
        filePattern: "*.md"

  -
    description: 'DBHelper - Architecture'
    outputPath: 'modules/db-helper/architecture.md'
    sources:
        - type: file
          description: "Public Interfaces and DTOs"
          sourcePaths:
            - src/classes/DBHelper
          filePattern: "*.php"
          contains:
            - "interface"
            - "abstract class"
          modifiers:
            - name: php-content-filter
              options:
                    method_visibility: [public]
                    keep_method_bodies: false
                    keep_doc_comments: true
                    exclude_methods:
                      - __construct


  ## ---------------------------------------------------------------
  ## APPLICATION SETS
  ## ---------------------------------------------------------------

  -
    description: 'Application Sets - Overview'
    outputPath: 'modules/application-sets/overview.md'
    sources:
      - type: file
        description: "Application Sets Overview"
        sourcePaths:
          - src/classes/Application/AppSets/README.md
        filePattern: "README.md"

  -
    description: 'Application Sets - Architecture'
    outputPath: 'modules/application-sets/architecture.md'
    sources:
      - type: file
        description: "Public Class Signatures"
        sourcePaths:
          - src/classes/Application/AppSets/
        excludePatterns:
          - 'Admin/'
        filePattern: "*.php"
        modifiers:
          - name: php-content-filter
            options:
              method_visibility: [public]
              keep_method_bodies: false
              keep_doc_comments: true
              exclude_methods:
                - __construct

  -
    description: 'Application Sets - Administration Interface'
    outputPath: 'modules/application-sets/admin-interface.md'
    sources:
      - type: file
        description: "Public Class Signatures"
        sourcePaths:
          - src/classes/Application/AppSets/Admin
        filePattern: "*.php"
        modifiers:
          - name: php-content-filter
            options:
              method_visibility: [public]
              keep_method_bodies: false
              keep_doc_comments: true
              exclude_methods:
                - __construct
